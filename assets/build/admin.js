(()=>{"use strict";var e={n:d=>{var s=d&&d.__esModule?()=>d.default:()=>d;return e.d(s,{a:s}),s},d:(d,s)=>{for(var a in s)e.o(s,a)&&!e.o(d,a)&&Object.defineProperty(d,a,{enumerable:!0,get:s[a]})},o:(e,d)=>Object.prototype.hasOwnProperty.call(e,d)};const d=window.wp.element,s=window.wp.i18n,a=window.wp.apiFetch;var t=e.n(a);const l=window.wp.components,i=window.ReactJSXRuntime,r=({folders:e,selectedFolder:d,onSelectFolder:a})=>{const t=(e,s=null)=>e.filter((e=>e.parent_id===s)).map((s=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"media-folders-tree-item "+(d?.id===s.id?"active":""),onClick:()=>a(s),children:[(0,i.jsx)(l.Dashicon,{icon:"portfolio",className:"media-folders-tree-item-icon"}),(0,i.jsx)("span",{children:s.name})]}),(0,i.jsx)("div",{style:{marginLeft:20},children:t(e,s.id)})]},s.id)));return(0,i.jsx)("div",{className:"media-folders-tree",children:0===e.length?(0,i.jsx)("div",{className:"media-folders-empty",children:(0,s.__)("No folders found","media-folders")}):t(e)})},o=({attachments:e,selectedFolder:d})=>d?0===e.length?(0,i.jsx)("div",{className:"media-folders-empty",children:(0,s.__)("No media files in this folder","media-folders")}):(0,i.jsx)("div",{className:"media-folders-grid",children:e.map((e=>(0,i.jsxs)("div",{className:"media-folders-attachment",children:[(0,i.jsx)("img",{src:e.url,alt:e.title}),(0,i.jsx)("div",{className:"media-folders-attachment-title",children:e.title})]},e.id)))}):(0,i.jsx)("div",{className:"media-folders-empty",children:(0,s.__)("Select a folder to view its contents","media-folders")}),n=({onCreateFolder:e,selectedFolder:a,onUpdateFolder:t,onDeleteFolder:r})=>{const[o,n]=(0,d.useState)(!1),[c,m]=(0,d.useState)(""),[f,h]=(0,d.useState)(!1);return(0,i.jsxs)("div",{className:"media-folders-toolbar",children:[(0,i.jsx)(l.Button,{isPrimary:!0,onClick:()=>n(!0),children:(0,s.__)("New Folder","media-folders")}),a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Button,{isSecondary:!0,onClick:()=>{m(a.name),h(!0),n(!0)},children:(0,s.__)("Rename","media-folders")}),(0,i.jsx)(l.Button,{isDestructive:!0,onClick:()=>r(a.id),children:(0,s.__)("Delete","media-folders")})]}),o&&(0,i.jsxs)(l.Modal,{title:f?(0,s.__)("Rename Folder","media-folders"):(0,s.__)("Create New Folder","media-folders"),onRequestClose:()=>{n(!1),h(!1),m("")},children:[(0,i.jsx)(l.TextControl,{value:c,onChange:m,label:(0,s.__)("Folder Name","media-folders")}),(0,i.jsx)(l.Button,{isPrimary:!0,onClick:()=>{c.trim()&&(f?t(a.id,c):e(c,a?.id),m(""),n(!1),h(!1))},disabled:!c.trim(),children:f?(0,s.__)("Update","media-folders"):(0,s.__)("Create","media-folders")})]})]})},c=()=>{const[e,a]=(0,d.useState)([]),[c,m]=(0,d.useState)(null),[f,h]=(0,d.useState)([]),[p,u]=(0,d.useState)(!0),[j,x]=(0,d.useState)(null);(0,d.useEffect)((()=>{_()}),[]),(0,d.useEffect)((()=>{c&&w(c.id)}),[c]);const _=async()=>{try{const e=await t()({path:`${MediaFoldersAdmin.apiNamespace}/folders`});a(e.folders)}catch(e){x(e.message)}finally{u(!1)}},w=async e=>{u(!0);try{const d=await t()({path:`${MediaFoldersAdmin.apiNamespace}/folders/${e}/attachments`});h(d.attachments)}catch(e){x(e.message)}finally{u(!1)}};return j?(0,i.jsx)("div",{className:"notice notice-error",children:(0,i.jsx)("p",{children:j})}):(0,i.jsxs)("div",{className:"media-folders-container",children:[(0,i.jsxs)("div",{className:"media-folders-sidebar",children:[(0,i.jsx)(n,{onCreateFolder:async(e,d=null)=>{try{await t()({path:`${MediaFoldersAdmin.apiNamespace}/folders`,method:"POST",data:{name:e,parent_id:d}}),_()}catch(e){x(e.message)}},selectedFolder:c,onUpdateFolder:async(e,d)=>{try{await t()({path:`${MediaFoldersAdmin.apiNamespace}/folders/${e}`,method:"PUT",data:{name:d}}),_()}catch(e){x(e.message)}},onDeleteFolder:async e=>{if(window.confirm((0,s.__)("Are you sure you want to delete this folder?","media-folders")))try{await t()({path:`${MediaFoldersAdmin.apiNamespace}/folders/${e}`,method:"DELETE"}),m(null),_()}catch(e){x(e.message)}}}),p&&!e.length?(0,i.jsx)(l.Spinner,{}):(0,i.jsx)(r,{folders:e,selectedFolder:c,onSelectFolder:m})]}),(0,i.jsx)("div",{className:"media-folders-content",children:p?(0,i.jsx)("div",{className:"media-folders-loading",children:(0,i.jsx)(l.Spinner,{})}):(0,i.jsx)(o,{attachments:f,selectedFolder:c})})]})};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("media-folders-root");e&&(0,d.render)((0,i.jsx)(c,{}),e)}))})();